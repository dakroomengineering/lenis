{"version":3,"file":"lenis.umd.js","sources":["../src/lenis.js","../src/maths.js"],"sourcesContent":["import EventEmitter from 'tiny-emitter'\nimport VirtualScroll from 'virtual-scroll'\nimport { clamp, lerp } from './maths.js'\n\nexport default class Lenis extends EventEmitter {\n  constructor({ lerp = 0.1, smooth = true, direction = 'vertical' } = {}) {\n    super()\n\n    this.lerp = lerp\n    this.smooth = smooth\n    this.direction = direction\n\n    window.addEventListener('scroll', this.onScroll, false)\n    window.addEventListener('resize', this.onWindowResize, false)\n\n    const platform =\n      navigator?.userAgentData?.platform || navigator?.platform || 'unknown'\n\n    // listen and normalize wheel event cross-browser\n    this.virtualScroll = new VirtualScroll({\n      firefoxMultiplier: 50,\n      mouseMultiplier: platform.indexOf('Win') > -1 ? 1 : 0.4,\n      useKeyboard: false,\n      useTouch: false,\n      passive: false,\n    })\n\n    this.virtualScroll.on(this.onVirtualScroll)\n\n    this.onWindowResize()\n    this.limit =\n      this.direction === 'horizontal'\n        ? document.body.offsetWidth - this.windowWidth\n        : document.body.offsetHeight - this.windowHeight\n\n    // recalculate maxScroll when body height changes\n    this.resizeObserver = new ResizeObserver(this.onResize)\n    this.resizeObserver.observe(document.body)\n\n    this.targetScroll = this.scroll =\n      this.direction === 'horizontal' ? window.scrollX : window.scrollY\n    this.velocity = 0\n  }\n\n  start() {\n    this.stopped = false\n  }\n\n  stop() {\n    this.stopped = true\n  }\n\n  destroy() {\n    window.removeEventListener('scroll', this.onScroll, false)\n    window.removeEventListener('resize', this.onWindowResize, false)\n    this.virtualScroll.destroy()\n    this.resizeObserver.disconnect()\n  }\n\n  onResize = (entries) => {\n    const entry = entries[0]\n    if (entry) {\n      const rect = entry.contentRect\n      this.limit =\n        this.direction === 'horizontal'\n          ? rect.width - this.windowWidth\n          : rect.height - this.windowHeight\n    }\n  }\n\n  onWindowResize = () => {\n    this.windowHeight = window.innerHeight\n    this.windowWidth = window.innerWidth\n  }\n\n  onVirtualScroll = ({ deltaY, originalEvent: e }) => {\n    if (this.stopped) {\n      e.preventDefault()\n      return\n    }\n\n    // prevent native wheel scrolling\n    if (this.smooth && !e.ctrlKey) e.preventDefault()\n\n    this.targetScroll -= deltaY\n    this.targetScroll = clamp(0, this.targetScroll, this.limit)\n  }\n\n  raf() {\n    if (this.stopped || !this.smooth) return\n    // where smooth scroll happens\n\n    let lastScroll = this.scroll\n\n    // lerp scroll value\n    this.scroll = lerp(this.scroll, this.targetScroll, this.lerp)\n    if (Math.round(this.scroll) === Math.round(this.targetScroll)) {\n      this.scroll = lastScroll = this.targetScroll\n    }\n\n    this.velocity = this.scroll - lastScroll\n\n    if (this.scrolling) {\n      // scroll to lerped scroll value\n      this.direction === 'horizontal'\n        ? window.scrollTo(this.scroll, 0)\n        : window.scrollTo(0, this.scroll)\n      this.notify()\n    }\n\n    this.scrolling = this.scroll !== this.targetScroll\n  }\n\n  onScroll = (e) => {\n    if (this.stopped) return\n\n    // if scrolling is false we can estimate use isn't scrolling with wheel (cmd+F, keyboard or whatever). So we must scroll to without any easing\n    if (!this.scrolling || !this.smooth) {\n      // where native scroll happens\n\n      const lastScroll = this.scroll\n      this.targetScroll = this.scroll =\n        this.direction === 'horizontal' ? window.scrollX : window.scrollY\n      this.velocity = this.scroll - lastScroll\n      this.notify()\n    }\n  }\n\n  notify() {\n    this.emit('scroll', {\n      scroll: this.scroll,\n      limit: this.limit,\n      velocity: this.velocity,\n      direction: this.direction,\n    })\n  }\n\n  scrollTo(target, { offset = 0, immediate= false } = {}) {\n    let value\n\n    if (typeof target === 'number') {\n      // Number\n      value = target\n    } else if (target === 'top') {\n      value = 0\n    } else if (target === 'bottom') {\n      value = this.limit\n    } else {\n      let node\n\n      if (typeof target === 'string') {\n        // CSS selector\n        node = document.querySelector(target)\n      } else if (target?.nodeType) {\n        // Node element\n        node = target\n      } else {\n        return\n      }\n\n      if (!target) return\n      const rect = node.getBoundingClientRect()\n      value =\n        (this.direction === 'horizontal' ? rect.left : rect.top) + this.scroll\n    }\n\n    value += offset\n\n    this.targetScroll = value\n    this.scrolling = true\n    \n    if (!this.smooth || immediate) {\n      this.scroll = value\n      if (this.direction === 'horizontal') {\n        window.scrollTo(this.scroll, 0)\n      } else {\n        window.scrollTo(0, this.scroll)\n      }\n    }\n  }\n}\n","export function clamp(min, input, max) {\n  return Math.max(min, Math.min(input, max))\n}\n\nexport function mapRange(in_min, in_max, input, out_min, out_max) {\n  return ((input - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min\n}\n\nexport function lerp(start, end, amt) {\n  return (1 - amt) * start + amt * end\n}\n\nexport function truncate(value, decimals) {\n  return parseFloat(value.toFixed(decimals))\n}\n"],"names":["_navigator","_navigator$userAgentD","_navigator2","_this","_ref","_temp","lerp","_ref$lerp","smooth","_ref$smooth","direction","_ref$direction","_EventEmitter","call","this","onResize","entries","entry","contentRect","limit","rect","width","windowWidth","height","windowHeight","onWindowResize","window","innerHeight","innerWidth","onVirtualScroll","_ref2","deltaY","e","originalEvent","stopped","preventDefault","ctrlKey","targetScroll","Math","max","min","onScroll","scrolling","lastScroll","scroll","scrollX","scrollY","velocity","notify","addEventListener","navigator","userAgentData","platform","virtualScroll","VirtualScroll","firefoxMultiplier","mouseMultiplier","indexOf","useKeyboard","useTouch","passive","on","document","body","offsetWidth","offsetHeight","resizeObserver","ResizeObserver","observe","start","stop","destroy","removeEventListener","disconnect","raf","amt","round","scrollTo","emit","target","_temp2","_ref3$offset","_ref3","offset","immediate","_ref3$immediate","value","node","querySelector","nodeType","getBoundingClientRect","left","top","EventEmitter"],"mappings":"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"}